<!DOCTYPE html>
<html >

<head>

  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>master thesis template</title>
  <meta name="description" content="Generalized linear mixed models, MCMC algorithms, Spatial generalized linear mixed models, Stan platform.">
  <meta name="generator" content="bookdown  and GitBook 2.6.7">

  <meta property="og:title" content="master thesis template" />
  <meta property="og:type" content="book" />
  
  <meta property="og:image" content="images/logo.png" />
  <meta property="og:description" content="Generalized linear mixed models, MCMC algorithms, Spatial generalized linear mixed models, Stan platform." />
  <meta name="github-repo" content="XiangyunHuang/Thesis-Template-Bookdown" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="master thesis template" />
  
  <meta name="twitter:description" content="Generalized linear mixed models, MCMC algorithms, Spatial generalized linear mixed models, Stan platform." />
  <meta name="twitter:image" content="images/logo.png" />

<meta name="author" content="Xiang-Yun Huang">


<meta name="date" content="2018-09-27">

  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  
  <link rel="shortcut icon" href="images/favicon.ico" type="image/x-icon">
<link rel="prev" href="prepare.html">
<link rel="next" href="algorithms.html">
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />









<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(data-line-number);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">空间广义线性混合效应模型及其应用</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> 绪论</a><ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#motivations"><i class="fa fa-check"></i><b>1.1</b> 研究意义</a></li>
<li class="chapter" data-level="1.2" data-path="index.html"><a href="index.html#reviews"><i class="fa fa-check"></i><b>1.2</b> 文献综述</a></li>
<li class="chapter" data-level="1.3" data-path="index.html"><a href="index.html#stracture"><i class="fa fa-check"></i><b>1.3</b> 论文结构</a></li>
<li class="chapter" data-level="1.4" data-path="index.html"><a href="index.html#Conventions-Colophon"><i class="fa fa-check"></i><b>1.4</b> 符号说明</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="prepare.html"><a href="prepare.html"><i class="fa fa-check"></i><b>2</b> 基础知识</a><ul>
<li class="chapter" data-level="2.1" data-path="prepare.html"><a href="prepare.html#sec:exp"><i class="fa fa-check"></i><b>2.1</b> 指数族</a></li>
<li class="chapter" data-level="2.2" data-path="prepare.html"><a href="prepare.html#lse"><i class="fa fa-check"></i><b>2.2</b> 最小二乘估计</a></li>
<li class="chapter" data-level="2.3" data-path="prepare.html"><a href="prepare.html#def-mle"><i class="fa fa-check"></i><b>2.3</b> 极大似然估计</a></li>
<li class="chapter" data-level="2.4" data-path="prepare.html"><a href="prepare.html#section-2.4"><i class="fa fa-check"></i><b>2.4</b> 随机过程的连续性和可微性</a></li>
<li class="chapter" data-level="2.5" data-path="prepare.html"><a href="prepare.html#stationary-gaussian-process"><i class="fa fa-check"></i><b>2.5</b> 平稳高斯过程</a></li>
<li class="chapter" data-level="2.6" data-path="prepare.html"><a href="prepare.html#Modified-Bessel-functions"><i class="fa fa-check"></i><b>2.6</b> 修正的第三类贝塞尔函数</a></li>
<li class="chapter" data-level="2.7" data-path="prepare.html"><a href="prepare.html#Laplace-approximation"><i class="fa fa-check"></i><b>2.7</b> 拉普拉斯近似</a></li>
<li class="chapter" data-level="2.8" data-path="prepare.html"><a href="prepare.html#Jeffreys-prior"><i class="fa fa-check"></i><b>2.8</b> Jeffreys 先验分布</a></li>
<li class="chapter" data-level="2.9" data-path="prepare.html"><a href="prepare.html#bayes-methods"><i class="fa fa-check"></i><b>2.9</b> 贝叶斯理论</a></li>
<li class="chapter" data-level="2.10" data-path="prepare.html"><a href="prepare.html#bayesian-data-analysis"><i class="fa fa-check"></i><b>2.10</b> 贝叶斯数据分析</a></li>
<li class="chapter" data-level="2.11" data-path="prepare.html"><a href="prepare.html#Curse-of-Dimensionality"><i class="fa fa-check"></i><b>2.11</b> 维数灾难与蒙特卡罗积分</a></li>
<li class="chapter" data-level="2.12" data-path="prepare.html"><a href="prepare.html#Samplers"><i class="fa fa-check"></i><b>2.12</b> 采样器与 Stan</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="models.html"><a href="models.html"><i class="fa fa-check"></i><b>3</b> 统计模型</a><ul>
<li class="chapter" data-level="3.1" data-path="models.html"><a href="models.html#Linear-Models"><i class="fa fa-check"></i><b>3.1</b> 线性模型</a></li>
<li class="chapter" data-level="3.2" data-path="models.html"><a href="models.html#Generalized-Linear-Models"><i class="fa fa-check"></i><b>3.2</b> 广义线性模型</a></li>
<li class="chapter" data-level="3.3" data-path="models.html"><a href="models.html#Linear-Mixed-Effects-Models"><i class="fa fa-check"></i><b>3.3</b> 线性混合效应模型</a></li>
<li class="chapter" data-level="3.4" data-path="models.html"><a href="models.html#Generalized-Linear-Mixed-Effects-Models"><i class="fa fa-check"></i><b>3.4</b> 广义线性混合效应模型</a></li>
<li class="chapter" data-level="3.5" data-path="models.html"><a href="models.html#section-3.5"><i class="fa fa-check"></i><b>3.5</b> 空间线性混合效应模型</a></li>
<li class="chapter" data-level="3.6" data-path="models.html"><a href="models.html#Spatial-Generalized-linear-mixed-effects-models"><i class="fa fa-check"></i><b>3.6</b> 空间广义线性混合效应模型</a><ul>
<li class="chapter" data-level="3.6.1" data-path="models.html"><a href="models.html#intro-sglmm"><i class="fa fa-check"></i><b>3.6.1</b> 模型结构</a></li>
<li class="chapter" data-level="3.6.2" data-path="models.html"><a href="models.html#covariance-function"><i class="fa fa-check"></i><b>3.6.2</b> 协方差函数</a></li>
<li class="chapter" data-level="3.6.3" data-path="models.html"><a href="models.html#identify"><i class="fa fa-check"></i><b>3.6.3</b> 模型识别</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="algorithms.html"><a href="algorithms.html"><i class="fa fa-check"></i><b>4</b> 参数估计</a><ul>
<li class="chapter" data-level="4.1" data-path="algorithms.html"><a href="algorithms.html#mle"><i class="fa fa-check"></i><b>4.1</b> 极大似然估计</a></li>
<li class="chapter" data-level="4.2" data-path="algorithms.html"><a href="algorithms.html#profile-likelihood"><i class="fa fa-check"></i><b>4.2</b> 剖面似然估计</a></li>
<li class="chapter" data-level="4.3" data-path="algorithms.html"><a href="algorithms.html#maximum-likelihood-estimates"><i class="fa fa-check"></i><b>4.3</b> 极大似然估计</a></li>
<li class="chapter" data-level="4.4" data-path="algorithms.html"><a href="algorithms.html#algrithms"><i class="fa fa-check"></i><b>4.4</b> 参数估计的算法</a><ul>
<li class="chapter" data-level="4.4.1" data-path="algorithms.html"><a href="algorithms.html#LA"><i class="fa fa-check"></i><b>4.4.1</b> 拉普拉斯近似算法</a></li>
<li class="chapter" data-level="4.4.2" data-path="algorithms.html"><a href="algorithms.html#MCML"><i class="fa fa-check"></i><b>4.4.2</b> 蒙特卡罗极大似然算法</a></li>
<li class="chapter" data-level="4.4.3" data-path="algorithms.html"><a href="algorithms.html#MCMC"><i class="fa fa-check"></i><b>4.4.3</b> 贝叶斯 MCMC 算法</a></li>
<li class="chapter" data-level="4.4.4" data-path="algorithms.html"><a href="algorithms.html#LowRank"><i class="fa fa-check"></i><b>4.4.4</b> 低秩近似算法</a></li>
</ul></li>
<li class="chapter" data-level="4.5" data-path="algorithms.html"><a href="algorithms.html#STAN-MCMC"><i class="fa fa-check"></i><b>4.5</b> 贝叶斯 STAN-MCMC 算法</a><ul>
<li class="chapter" data-level="4.5.1" data-path="algorithms.html"><a href="algorithms.html#section-4.5.1"><i class="fa fa-check"></i><b>4.5.1</b> 算法提出的背景和意义</a></li>
<li class="chapter" data-level="4.5.2" data-path="algorithms.html"><a href="algorithms.html#STANMCMC"><i class="fa fa-check"></i><b>4.5.2</b> STAN-MCMC 算法实现过程</a></li>
<li class="chapter" data-level="4.5.3" data-path="algorithms.html"><a href="algorithms.html#-r-"><i class="fa fa-check"></i><b>4.5.3</b> 求解模型的 R 包</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="simulations.html"><a href="simulations.html"><i class="fa fa-check"></i><b>5</b> 数值模拟</a><ul>
<li class="chapter" data-level="5.1" data-path="simulations.html"><a href="simulations.html#section-5.1"><i class="fa fa-check"></i><b>5.1</b> 一维空间高斯过程</a></li>
<li class="chapter" data-level="5.2" data-path="simulations.html"><a href="simulations.html#sim-gp"><i class="fa fa-check"></i><b>5.2</b> 平稳空间高斯过程</a></li>
<li class="chapter" data-level="5.3" data-path="simulations.html"><a href="simulations.html#sim-sglmm"><i class="fa fa-check"></i><b>5.3</b> 空间广义线性混合效应模型</a><ul>
<li class="chapter" data-level="5.3.1" data-path="simulations.html"><a href="simulations.html#binomal-sglmm"><i class="fa fa-check"></i><b>5.3.1</b> 响应变量服从二项分布</a></li>
<li class="chapter" data-level="5.3.2" data-path="simulations.html"><a href="simulations.html#possion-sglmm"><i class="fa fa-check"></i><b>5.3.2</b> 响应变量服从泊松分布</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="applications.html"><a href="applications.html"><i class="fa fa-check"></i><b>6</b> 数据分析</a><ul>
<li class="chapter" data-level="6.1" data-path="applications.html"><a href="applications.html#sptial-random-effects"><i class="fa fa-check"></i><b>6.1</b> 空间线性混合效应模型</a></li>
<li class="chapter" data-level="6.2" data-path="applications.html"><a href="applications.html#loaloa"><i class="fa fa-check"></i><b>6.2</b> 喀麦隆及周边地区盘尾丝虫病的空间分布</a></li>
<li class="chapter" data-level="6.3" data-path="applications.html"><a href="applications.html#rongelap"><i class="fa fa-check"></i><b>6.3</b> 朗格拉普岛放射性残留物的空间分布</a></li>
<li class="chapter" data-level="6.4" data-path="applications.html"><a href="applications.html#section-6.4"><i class="fa fa-check"></i><b>6.4</b> 冈比亚儿童疟疾流行强度的空间分布</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="summary.html"><a href="summary.html"><i class="fa fa-check"></i><b>7</b> 总结展望</a></li>
<li class="chapter" data-level="" data-path="author.html"><a href="author.html"><i class="fa fa-check"></i>作者简介</a></li>
<li class="chapter" data-level="" data-path="appendix.html"><a href="appendix.html"><i class="fa fa-check"></i>附录</a><ul>
<li class="chapter" data-level="" data-path="appendix.html"><a href="appendix.html#sessioninfo"><i class="fa fa-check"></i>软件信息</a></li>
<li class="chapter" data-level="" data-path="appendix.html"><a href="appendix.html#random-number-generation"><i class="fa fa-check"></i>随机数生成</a></li>
<li class="chapter" data-level="" data-path="appendix.html"><a href="appendix.html#compare-algrithms"><i class="fa fa-check"></i>算法比较</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="References.html"><a href="References.html"><i class="fa fa-check"></i>参考文献</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">master thesis template</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="models" class="section level1">
<h1><span class="header-section-number">第 3 章</span> 统计模型</h1>
<p><span class="todo">重新安排逻辑顺序第三章 空间广义线性混合效应模型 1. 模型结构</span></p>
<p>第 <a href="models.html#Linear-Models">3.1</a> 节，第 <a href="models.html#Generalized-Linear-Models">3.2</a> 节和第 <a href="models.html#Generalized-Linear-Mixed-Effects-Models">3.4</a> 节简略介绍了线性模型， 广义线性模型和广义线性混合效应模型及其数学表示， 并随同模型给出了模型求解的 R 包或函数， 为空间广义线性混合效应模型的介绍做铺垫。第 <a href="models.html#Spatial-Generalized-linear-mixed-effects-models">3.6</a> 节重点介绍了空间广义线性混合效应模型（以下简称为 SGLMM 模型）， 并分三小节介绍模型中的重要成分， 第 小节介绍 SGLMM 模型中的空间效应， 即平稳空间高斯过程， 第 <a href="models.html#covariance-function">3.6.2</a> 小节介绍影响空间效应结构的关键部分 — 自协方差函数和平稳空间高斯过程的核函数或自相关函数， 第 <a href="models.html#identify">3.6.3</a> 小节介绍非空间的随机效应，在地质统计中常称为块金效应，以及它带来的 SGLMM 模型可识别问题与相应处理方式。</p>
<div id="Linear-Models" class="section level2">
<h2><span class="header-section-number">3.1</span> 线性模型</h2>
<p>线性模型的一般形式为</p>
<p><span class="math display" id="eq:LM">\[\begin{equation}
Y = X^{\top}\beta + \epsilon, \mathrm{E}(\epsilon) = 0, \mathrm{Cov}(\epsilon) = \sigma^2\mathbf{I}  \tag{3.1}
\end{equation}\]</span></p>
<p>其中，<span class="math inline">\(Y = (y_1,y_2,\ldots,y_n)^{\top}\)</span> 是 <span class="math inline">\(n\)</span> 维列向量，代表对响应变量 <span class="math inline">\(Y\)</span> 的 <span class="math inline">\(n\)</span> 次观测； <span class="math inline">\(\beta = (\beta_0,\beta_1,\ldots,\beta_{p-1})^{\top}\)</span> 是 <span class="math inline">\(p\)</span> 维列向量， 代表模型 <a href="models.html#eq:LM">(3.1)</a> 的协变量 <span class="math inline">\(X\)</span> 的系数，<span class="math inline">\(\beta_0\)</span> 是截距项； <span class="math inline">\(X^{\top} = (1_{(1\times n)}^{\top},X_{(1)}^{\top},X_{(2)}^{\top},\ldots,X_{(p-1)}^{\top})\)</span>， <span class="math inline">\(1_{(1\times n)}^{\top}\)</span> 是全 1 的 <span class="math inline">\(n\)</span> 维列向量，而 <span class="math inline">\(X_{(i)}^{\top} = (x_{1i},x_{2i},\ldots,x_{ni})^{\top}\)</span> 代表对第 <span class="math inline">\(i\)</span> 个自变量的 <span class="math inline">\(n\)</span> 次观测； <span class="math inline">\(\epsilon = (\epsilon_1,\epsilon_2,\ldots,\epsilon_n)^{\top}\)</span> 是 <span class="math inline">\(n\)</span> 维列向量，代表模型的随机误差，并且假定 <span class="math inline">\(\mathrm{E}(\epsilon_i \epsilon_j) = 0, i \ne j\)</span>， 即模型误差项之间线性无关，且方差齐性，都是 <span class="math inline">\(\sigma^2(&gt;0)\)</span>。 估计模型 <a href="models.html#eq:LM">(3.1)</a> 的参数常用最小二乘和最大似然方法， 求解线性模型 <a href="models.html#eq:LM">(3.1)</a> 的参数可以用 R 函数 <code>lm</code>，近年来，高维乃至超高维稀疏线性模型成为热门的研究方向，相关的 R 包也越来越多，比较流行的有 <strong>glmnet</strong> <span class="citation">(Simon et al. <a href="#ref-glmnet2011JSS">2011</a>)</span> 和 <strong>SIS</strong> <span class="citation">(Saldana and Feng <a href="#ref-SIS2016JSS">2018</a>)</span>。</p>
<!-- 最小二乘估计/最大似然估计 回归系数与方差 -->
</div>
<div id="Generalized-Linear-Models" class="section level2">
<h2><span class="header-section-number">3.2</span> 广义线性模型</h2>
<p>广义线性模型的一般形式</p>
<p><span class="math display" id="eq:GLM">\[\begin{equation}
g(\mu) = X^{\top}\beta  \tag{3.2}
\end{equation}\]</span></p>
<p>其中，<span class="math inline">\(\mu \equiv \mathrm{E}(Y)\)</span>， <span class="math inline">\(g\)</span> 代表联系函数，特别地，当 <span class="math inline">\(Y \sim N(\mu,\sigma^2)\)</span> 时，联系函数 <span class="math inline">\(g(x) = x\)</span>，模型 <a href="models.html#eq:GLM">(3.2)</a> 变为一般线性模型 <a href="models.html#eq:LM">(3.1)</a>。当 <span class="math inline">\(Y \sim \mathrm{Binomial}(n,p)\)</span> 时，响应变量 <span class="math inline">\(Y\)</span> 的期望 <span class="math inline">\(\mu =\mathrm{E}(Y) = np\)</span>， 联系函数 <span class="math inline">\(g(x)=\ln(\frac{x}{1-x})\)</span>，模型 <a href="models.html#eq:GLM">(3.2)</a> 变为<span class="math inline">\(\log(\frac{p}{1-p})=X^{\top}\beta\)</span>。 当 <span class="math inline">\(Y \sim \mathrm{Possion}(\lambda)\)</span> 时，响应变量 <span class="math inline">\(Y\)</span> 的期望 <span class="math inline">\(\mu =\mathrm{E}(Y) = \lambda\)</span>， 联系函数<span class="math inline">\(g(x) = \ln(x)\)</span>， 模型 <a href="models.html#eq:GLM">(3.2)</a> 变为 <span class="math inline">\(\log(\lambda) = X^{\top}\beta\)</span>。 指数族下其余分布对应的联系函数此处不一一列举， 完整列表可以参看 1989 年 McCullagh 和 Nelder 所著的《广义线性模型》 <span class="citation">(McCullagh and Nelder <a href="#ref-McCullagh1989">1989</a>)</span>。 模型 <a href="models.html#eq:GLM">(3.2)</a> 最早由 Nelder 和 Wedderburn 在1972年提出<span class="citation">(Nelder and Wedderburn <a href="#ref-Nelder1972">1972</a>)</span>，它弥补了模型 <a href="models.html#eq:LM">(3.1)</a> 的两个重要缺点： 一是因变量只能取连续值的情况， 二是期望与自变量只能用线性关系联系 <span class="citation">(陈希孺 <a href="#ref-Chen2011">2011</a>)</span>。 求解广义线性模型 <a href="models.html#eq:GLM">(3.2)</a> 的 R 函数是 <code>glm</code>， 常用拟似然法去估计模型 <a href="models.html#eq:GLM">(3.2)</a> 的参数。</p>
<!-- 最小二乘估计/极大似然估计 回归系数与方差 -->
</div>
<div id="Linear-Mixed-Effects-Models" class="section level2">
<h2><span class="header-section-number">3.3</span> 线性混合效应模型</h2>
<p>模型结构，参数估计，惩罚最小二乘和广义最小二乘
极大似然估计和限制极大似然估计 lme4 包 <span class="citation">(Bates et al. <a href="#ref-Bates2015">2015</a>)</span>
剖面似然估计 profile 似然</p>
</div>
<div id="Generalized-Linear-Mixed-Effects-Models" class="section level2">
<h2><span class="header-section-number">3.4</span> 广义线性混合效应模型</h2>
<p>广义线性混合模型的一般形式</p>
<p><span class="math display" id="eq:GLMM">\[\begin{equation}
g(\mu) = X^{\top}\boldsymbol{\beta} + Z^{\top}\mathbf{b}  \tag{3.3}
\end{equation}\]</span></p>
<p>其中， <span class="math inline">\(Z^{\top}\)</span> 是 <span class="math inline">\(q\)</span> 维随机效应 <span class="math inline">\(\mathbf{b}\)</span> 的 <span class="math inline">\(n \times q\)</span> 的数据矩阵，其它符号含义如前所述。广义线性混合效应模型中既包含固定效应 <span class="math inline">\(\boldsymbol{\beta}\)</span> 又包含随机效应 <span class="math inline">\(\mathbf{b}\)</span> 。 线性模型 <a href="models.html#eq:LM">(3.1)</a> 和广义线性模型 <a href="models.html#eq:GLM">(3.2)</a> 中的协变量都是固定效应， 而随机效应是那些不能直接观察到的潜效应， 但是对响应变量却产生显著影响。 特别是在基因变异位点与表现型的关系研究中， 除了用最新科技做全基因组扫描获取显著的基因位点， 还应该把那些看似不显著， 联合在一起却显著的位点作为随机效应去考虑 <span class="citation">(Yang et al. <a href="#ref-Yang2010Common">2010</a>)</span>。求解模型 <a href="models.html#eq:GLMM">(3.3)</a>的 R 包有 <strong>nlme</strong> ，<strong>mgcv</strong> 和 <strong>lme4</strong>， 参数估计的方法一般有限制极大似然法。 除了求解模型 <a href="models.html#eq:GLMM">(3.3)</a> 外， <strong>nlme</strong> 可以拟合一些非线性混合效应模型， <strong>mgcv</strong> 可以拟合广义可加混合效应模型， <strong>lme4</strong> 使用了高性能的 Eigen 数值代数库，可以加快模型的求解过程。</p>
<p>MCMC 方法应用于 GLMM 模型 <span class="citation">(Hadfield <a href="#ref-MCMCglmm2010">2010</a>)</span></p>
</div>
<div id="section-3.5" class="section level2">
<h2><span class="header-section-number">3.5</span> 空间线性混合效应模型</h2>
<p>Kriging 插值 <span class="citation">(Pebesma <a href="#ref-gstat2004">2004</a>; Gräler, Pebesma, and Heuvelink <a href="#ref-gstat2016">2016</a>)</span>
gstat: Spatial and Spatio-Temporal Geostatistical Modelling, Prediction and Simulation</p>
</div>
<div id="Spatial-Generalized-linear-mixed-effects-models" class="section level2">
<h2><span class="header-section-number">3.6</span> 空间广义线性混合效应模型</h2>
<p>在提出 SGLMM 模型之前，先介绍空间高斯过程，然后是平稳空间高斯过程和SGLMM模型结构，以步步推进的方式引入各成分的假设条件，其后着重阐述了空间效应的自相关函数，它决定空间效应，包含模型中的待估参数。</p>
<div id="intro-sglmm" class="section level3">
<h3><span class="header-section-number">3.6.1</span> 模型结构</h3>
<p>空间广义线性混合效应模型是对模型 <a href="models.html#eq:GLMM">(3.3)</a> 的进一步延伸，其一般形式为</p>
<p><span class="math display" id="eq:SGLMM">\[\begin{equation}
g(\mu_i) = d(x_i)^{\top}\beta + S(x_i) + Z_i \tag{3.4}
\end{equation}\]</span></p>
<p>其中，<span class="math inline">\(d^{\top}(x_i)\)</span> 表示协变量对应的观测数据向量，即 <span class="math inline">\(p\)</span> 个协变量在第 <span class="math inline">\(i\)</span> 个位置 <span class="math inline">\(x_i\)</span> 的观察值。 此外， 假定 <span class="math inline">\(\mathcal{S} = \{S(x): x \in \mathbb{R}^2\}\)</span> 是均值为0， 方差为 <span class="math inline">\(\sigma^2\)</span>，平稳且各向同性的空间高斯过程， <span class="math inline">\(\rho(x,x&#39;) = \mathrm{Corr}\{S(x),S(x&#39;)\} \equiv \rho(\|x,x&#39;\|)\)</span>， <span class="math inline">\(\|\cdot\|\)</span> 表示距离， 样本之间的位置间隔不大就用欧氏距离， 间隔很大可以考虑用球面距离； <span class="math inline">\(S(x_i)\)</span> 代表了与空间位置 <span class="math inline">\(x_i\)</span> 相关的随机效应， 简称空间效应； 这里， <span class="math inline">\(Z_i \stackrel{i.i.d}{\sim} N(0,\tau^2)\)</span> 的非空间随机效应， 也称块金效应 (nugget effect)， 一般解释为测量误差 (measurement error) 或微观变化 (micro-scale variation) <span class="citation">(Christensen <a href="#ref-Christensen2004">2004</a>)</span>， 即 <span class="math inline">\(\tau^2=\mathrm{Var}(Y_{i}|S(x_{i})),\forall i = 1,2, \ldots, N\)</span>， <span class="math inline">\(N\)</span> 是采样点的数目， 其它符号含义不变。</p>
</div>
<div id="covariance-function" class="section level3">
<h3><span class="header-section-number">3.6.2</span> 协方差函数</h3>
<p>随机过程的协方差函数，也称核函数，如无特殊说明，文中所指都是自协方差函数，模型 <a href="models.html#eq:SGLMM">(3.4)</a> 的空间效应结构由相关函数决定， 在给出相关函数之前， 先计算一下空间效应的理论变差 <span class="math inline">\(V(x,x&#39;)\)</span>， 即空间过程的协方差函数的一半， 变差源于采矿术语， 和线性预测 <span class="math inline">\(T_{i}\)</span> 的变差 <span class="math inline">\(V_{T}(u_{ij})\)</span>。 为方便起见，记 <span class="math inline">\(T_{i} = d(x_i)^{\top}\beta + S(x_i) + Z_i\)</span></p>
<p><span class="math display" id="eq:variograms">\[\begin{equation}
\begin{aligned}
V(x,x&#39;) 
&amp;= \frac{1}{2}\mathrm{Var}\{S(x)-S(x&#39;)\}\\
&amp;= \frac{1}{2}\mathrm{Cov}(S(x)-S(x&#39;),S(x)-S(x&#39;))\\
&amp;= \frac{1}{2}\{E[S(x)-S(x&#39;)][S(x)-S(x&#39;)]-[E(S(x)-S(x&#39;))]^2\}\\
&amp;= \sigma^2-\mathrm{Cov}(S(x),S(x&#39;))=\sigma^2\{1-\rho(u)\}\\
V_{T}(u_{ij})
&amp;= \frac{1}{2}\mathrm{Var}\{T_{i}(x)-T_{j}(x)\} \\
&amp;= \frac{1}{2}\mathrm{E}[(T_{i}-T_{j})^2]=\tau^2+\sigma^2(1-\rho(u_{ij})) 
\end{aligned} \tag{3.5}
\end{equation}\]</span></p>
<p>从方程 <a href="models.html#eq:variograms">(3.5)</a> 不难看出系数 <span class="math inline">\(\frac{1}{2}\)</span> 的化简作用，类似地，根据协方差定义可推知随机向量 <span class="math inline">\(T = (T_1,T_2,\ldots,T_n)\)</span> 的协方差矩阵如下：</p>
<p><span class="math display">\[\begin{equation}
\begin{aligned}
\mathrm{Cov}(T_{i}(x),T_{i}(x)) &amp;= \mathrm{E}[S(x_i)]^2 + \mathrm{E}Z_{i}^{2}= \sigma^2+\tau^2 \\
\mathrm{Cov}(T_{i}(x),T_{j}(x)) &amp;= \mathrm{E}[S(x_i)S(x_j)]  = \sigma^2\rho(u_{ij})
\end{aligned}
\end{equation}\]</span></p>
<p>相关函数 <span class="math inline">\(\rho(u)\)</span> 的作用和地位就显而易见了，它是既决定理论变差又决定协方差矩阵的结构。</p>
<p>常见的自相关函数族有高斯协方差函数、球面协方差函数和 Matérn 协方差函数：</p>
<p><span class="math display" id="eq:matern1">\[\begin{equation}
\rho(u)=\{2^{\kappa -1}\Gamma(\kappa)\}^{-1}(u/\phi)^{\kappa}\mathcal{K}_{\kappa}(u/\phi),u &gt; 0 \tag{3.6}
\end{equation}\]</span></p>
<p>一般地，假定 <span class="math inline">\(\rho(u)\)</span> 单调不增，即任何两样本之间的相关性应该随距离变大而减弱，尺度参数 <span class="math inline">\(\phi\)</span> 控制函数 <span class="math inline">\(\rho(u)\)</span> 递减到0的速率。方便起见，记 <span class="math inline">\(\rho(u) = \rho_{0}(u/\phi)\)</span>，则方程 <a href="models.html#eq:matern1">(3.6)</a> 可简记为</p>
<p><span class="math display" id="eq:matern2">\[\begin{equation}
\rho_{0}(u)=\{2^{\kappa -1}\Gamma(\kappa)\}^{-1}(u)^{\kappa}\mathcal{K}_{\kappa}(u),u &gt; 0 \tag{3.7}
\end{equation}\]</span></p>
<p>其中，<span class="math inline">\(\mathcal{K}_{\kappa}(\cdot)\)</span> 是阶数为 <span class="math inline">\(\kappa\)</span> 的第二类修正的贝塞尔函数， <span class="math inline">\(\kappa(&gt;0)\)</span> 是平滑参数，满足这些条件的空间过程 <span class="math inline">\(\mathcal{S}\)</span> 是 <span class="math inline">\(\lceil\kappa\rceil-1\)</span> 次均方可微的。</p>
<p>值得注意的是 Matérn 族其实包含幂指数族
当 <span class="math inline">\(\kappa = 0.5\)</span>时，<span class="math inline">\(\rho_{0}(u) = \exp(-u)\)</span>， <span class="math inline">\(S(x)\)</span> 均方连续但是不可微，当 <span class="math inline">\(\kappa \to \infty\)</span> 时， <span class="math inline">\(\rho_{0}(u) = \exp(-u^2)\)</span>， <span class="math inline">\(S(x)\)</span> 无限次均方可微。</p>
<p>实际操作中，估计 <span class="math inline">\(\kappa\)</span>， 为了节省计算，又不失一般性，经验做法是取离散的 <span class="math inline">\(\kappa\)</span> 先验，如 <span class="math inline">\(\kappa = 0.5, 1.5, 2.5\)</span>， 分别对应 <span class="math inline">\(S(x)\)</span> 均方连续、一次可微和二次可微。实际上，<span class="math inline">\(\rho(u)\)</span> 的可微性表示了空间过程 <span class="math inline">\(\mathcal{S}\)</span> 的曲面平滑程度。为更加直观地描述 <span class="math inline">\(\rho(u)\)</span>，作图 <a href="models.html#fig:matern-2d">3.1</a>
<!-- 和图 \@ref(fig:matern-3d)  --></p>
<div class="figure" style="text-align: center"><span id="fig:matern-2d"></span>
<img src="figures/matern.png" alt="固定尺度参数，相关函数随距离的变化（左）；固定贝塞尔函数的阶，相关函数随距离的变化（右）" width="70%" />
<p class="caption">
图 3.1: 固定尺度参数，相关函数随距离的变化（左）；固定贝塞尔函数的阶，相关函数随距离的变化（右）
</p>
</div>
<p>从图上可以看出，相比于贝塞尔函数的阶 <span class="math inline">\(\kappa\)</span>， 尺度参数 <span class="math inline">\(\phi\)</span> 对相关函数的影响大些，所以在实际应用中，先固定下 <span class="math inline">\(\kappa\)</span> 是可以接受的。</p>
<p>为简化编程和描述，在1998年 Diggle 等人在数据分析中使用幂指数族 <span class="math inline">\(\rho_{0}(u) = \exp(-(\alpha u)^{\delta}), \alpha &gt; 0, 0 &lt; \delta \leq 2\)</span> 作为相关函数 <span class="citation">(Diggle, Tawn, and Moyeed <a href="#ref-Diggle1998">1998</a>)</span>。 虽然其形式大大简化， 函数图像和性质却与梅隆族相似， 即当 <span class="math inline">\(0 &lt; \delta &lt; 2\)</span> 时， <span class="math inline">\(S(x)\)</span> 均方连续但不可微，当 <span class="math inline">\(\delta = 2\)</span> 时， <span class="math inline">\(S(x)\)</span> 无限次可微。</p>
</div>
<div id="identify" class="section level3">
<h3><span class="header-section-number">3.6.3</span> 模型识别</h3>
<p>在 SGLMM 模型的实际应用当中，一般先不添加非空间的随机效应，而是基于模型 <a href="models.html#eq:no-nugget-SGLMM">(3.8)</a> 估计参数，估计完参数，代入模型，观察线性预测 <span class="math inline">\(\hat{T(x_{i})}\)</span> 和真实的 <span class="math inline">\(T(x_i)\)</span> 之间的残差，如残差表现不平稳，说明还有非空间的随机效应没有提取，因此添加块金效应是合理的，此时在模型 <a href="models.html#eq:SGLMM">(3.4)</a> 中有两个来源不同的随机效应 <span class="math inline">\(Z_{i}\)</span> 与 <span class="math inline">\(S(x_i)\)</span>。</p>
<p><span class="math display" id="eq:no-nugget-SGLMM">\[\begin{equation}
g(\mu_i) = d(x_i)^{\top}\beta + S(x_i) \tag{3.8}
\end{equation}\]</span></p>
<p>如何区分开 <span class="math inline">\(Z_{i}\)</span> 与 <span class="math inline">\(S(x_i)\)</span>，或者更直接地说，如何估计这两个随机效应的参数 <span class="math inline">\(\tau^2, \sigma^2, \phi\)</span>， 即为可识别问题。 向量 <span class="math inline">\(T = (T_1,T_2,\ldots,T_n)^{\top}\)</span> 是协方差为矩阵 <span class="math inline">\(\tau^2I + \sigma^2R\)</span> 的多元高斯分布， 其中， 自相关函数 <span class="math inline">\(R_{ij} = \rho(u_{ij}; \phi)\)</span>， <span class="math inline">\(u_{ij}\)</span> 是 <span class="math inline">\(x_i\)</span> 与 <span class="math inline">\(x_j\)</span> 之间的距离，由线性预测 <span class="math inline">\(T_{i}\)</span> 的变差公式 <a href="models.html#eq:variograms">(3.5)</a> 知，随机过程 <span class="math inline">\(T(x)\)</span> 的变差 <span class="math inline">\(\tau^2 + \sigma^2(1-\rho(u_{ij}))\)</span> 和自相关函数 <a href="models.html#eq:corr-nugget-function">(3.9)</a></p>
<p><span class="math display" id="eq:corr-nugget-function">\[\begin{equation}
\rho^{\star}(u) =
\begin{cases}
                                     1 &amp; : x_{i} = x_{j}  \\
\sigma^2\rho(u_{ij})/(\sigma^2+\tau^2) &amp; : x_{i} \neq x_{j}
\end{cases} \tag{3.9}
\end{equation}\]</span></p>
<p>在原点不连续，只有当 <span class="math inline">\(\tau^2 = \mathrm{Var}(Y_i|S(x_i))\)</span> 已知或者在同一位置可以用重复测量 的方法直接估计时，参数 <span class="math inline">\(\tau^2, \sigma^2, \phi\)</span> 是可识别的 <span class="citation">(P. Diggle et al. <a href="#ref-Diggle2002Childhood">2002</a>; Peter J. Diggle and Ribeiro Jr. <a href="#ref-Diggle2007">2007</a>)</span>。</p>
<!-- 如果诊断到不可忽略的非空间效应[@Christensen2004]， -->
<!-- ### 先验分布 {#prior} -->
<!-- 基于贝叶斯框架实现模型\@ref(eq:SGLMM)的参数估计和预测，必然使用 MCMC 算法，自然地，需要指定模型参数 $\boldsymbol{\theta} = (\beta,\tau^2,\sigma^2,\phi)$ 的先验分布，对于 $\beta$，选择相互独立的均匀先验，而对于参数 $\tau^2,\sigma^2,\phi$，选取如下模糊先验： -->
<!-- $$f(\tau^2) \propto \frac{1}{\tau^2};f(\sigma^2) \propto \frac{1}{\sigma^2};f(\phi) \propto \frac{1}{\phi^2}$$ -->
<!-- \noindent 其中，$\tau^2$ 和 $\sigma^2$ 为杰弗里斯先验，2002年 Peter J. Diggle 提出如下的分布 -->
<!-- \begin{equation*} -->
<!-- \log(\nu^2),\log(\sigma^2),\log(\phi)  \sim \text{正态分布}   -->
<!-- \end{equation*} -->
<!-- 这些无信息先验分布的选择是出于实用和经验的考虑（意思就是说可以取别的），只要使得马尔科夫链 收敛即可，实际操作中，我们还选取不同初始值，产生多条链，同时去掉迭代初始阶段产生的比较发散的值，在链条收敛的情况下，可以把它当作后验分布产生的样本，然后依据该样本估计后验分布的参数。这些无信息的先验分布的选择对最终结果几乎没有影响，这是贝叶斯非常棒的部分，贝叶斯推断方法也得以被广泛应用[@mao2006]。 -->
<!-- 作为模型 \@ref(eq:SGLMM) 求解和展示的首选工具 --- R 语言在空间数据分析与可视化方面呈现越来越流行的趋势，从早些年的 lattice 图形 [@lattice2008] 到如今的 ggplot2 图形[@ggplot22016]，操作空间数据的 sp 对象也发展为 sf 对象，还整合了不少第三方软件和服务，如基于 Google Maps 和 Google Earth 的交互式空间可视化。下面就求解模型 \@ref(eq:SGLMM)的三类算法 --- 贝叶斯方法、似然方法和低秩近似方法进行详细阐述。 -->

</div>
</div>
</div>
<h3>参考文献</h3>
<div id="refs" class="references">
<div id="ref-glmnet2011JSS">
<p>Simon, Noah, Jerome Friedman, Trevor Hastie, and Rob Tibshirani. 2011. “Regularization Paths for Cox’s Proportional Hazards Model via Coordinate Descent.” <em>Journal of Statistical Software</em> 39 (5): 1–13.</p>
</div>
<div id="ref-SIS2016JSS">
<p>Saldana, Diego Franco, and Yang Feng. 2018. “SIS: An R Package for Sure Independence Screening in Ultrahigh Dimensional Statistical Models.” <em>Journal of Statistical Software</em> 83 (2): 1–25.</p>
</div>
<div id="ref-McCullagh1989">
<p>McCullagh, Peter, and John Nelder. 1989. <em>Generalized Linear Models</em>. Second. London: Chapman; Hall/CRC.</p>
</div>
<div id="ref-Nelder1972">
<p>Nelder, John A., and R. W. M. Wedderburn. 1972. “Generalized Linear Models.” <em>Journal of the Royal Statistical Society, Series A</em> 135 (3): 370–84.</p>
</div>
<div id="ref-Chen2011">
<p>陈希孺. 2011. <em>广义线性模型的拟似然法</em>. 合肥: 中国科学技术大学出版社.</p>
</div>
<div id="ref-Bates2015">
<p>Bates, Douglas, Martin Mächler, Ben Bolker, and Steve Walker. 2015. “Fitting Linear Mixed-Effects Models Using lme4.” <em>Journal of Statistical Software</em> 67 (1): 1–48.</p>
</div>
<div id="ref-Yang2010Common">
<p>Yang, Jian, Beben Benyamin, Brian P Mcevoy, Scott Gordon, Anjali K Henders, Dale R Nyholt, Pamela A Madden, Andrew C Heath, Nicholas G Martin, and Grant W Montgomery. 2010. “Common Snps Explain a Large Proportion of Heritability for Human Height.” <em>Nature Genetics</em> 42 (7): 565–69.</p>
</div>
<div id="ref-MCMCglmm2010">
<p>Hadfield, Jarrod D. 2010. “MCMC Methods for Multi-Response Generalized Linear Mixed Models: The MCMCglmm R Package.” <em>Journal of Statistical Software</em> 33 (2): 1–22.</p>
</div>
<div id="ref-gstat2004">
<p>Pebesma, Edzer J. 2004. “Multivariable Geostatistics in S: The Gstat Package.” <em>Computers and Geosciences</em> 30 (7): 683–91.</p>
</div>
<div id="ref-gstat2016">
<p>Gräler, Benedikt, Edzer Pebesma, and Gerard Heuvelink. 2016. “Spatio-Temporal Interpolation Using Gstat.” <em>The R Journal</em> 8 (1): 204–18.</p>
</div>
<div id="ref-Christensen2004">
<p>Christensen, Ole F. 2004. “Monte Carlo Maximum Likelihood in Model-Based Geostatistics.” <em>Journal of Computational and Graphical Statistics</em> 13 (3): 702–18.</p>
</div>
<div id="ref-Diggle1998">
<p>Diggle, Peter J., J. A. Tawn, and R. A. Moyeed. 1998. “Model-Based Geostatistics.” <em>Journal of the Royal Statistical Society, Series C</em> 47 (3): 299–350.</p>
</div>
<div id="ref-Diggle2002Childhood">
<p>Diggle, Peter, Rana Moyeed, Barry Rowlingson, and Madeleine Thomson. 2002. “Childhood Malaria in the Gambia: A Case-Study in Model-Based Geostatistics.” <em>Journal of the Royal Statistical Society, Series C</em> 51 (4): 493–506.</p>
</div>
<div id="ref-Diggle2007">
<p>Diggle, Peter J., and Paulo J. Ribeiro Jr. 2007. <em>Model-Based Geostatistics</em>. New York, NY: Springer-Verlag.</p>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="prepare.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="algorithms.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"google": false,
"linkedin": false,
"weibo": false,
"instapper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/XiangyunHuang/Thesis-Template-Bookdown/edit/master/02-models.Rmd",
"text": "编辑"
},
"download": ["Thesis-Template-Bookdown.pdf", "Thesis-Template-Bookdown.epub", "Thesis-Template-Bookdown.mobi"],
"toc": {
"collapse": "none"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdn.bootcss.com/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:" && /^https?:/.test(src))
      src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
